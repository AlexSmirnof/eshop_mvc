-- SET REFERENTIAL_INTEGRITY FALSE;
SET DATABASE REFERENTIAL INTEGRITY FALSE;

DROP TABLE IF EXISTS Phones;
DROP TABLE IF EXISTS Orders;
DROP TABLE IF EXISTS OrderItems;
DROP TABLE IF EXISTS Users;


CREATE MEMORY TABLE Phones(
	  id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),
    model VARCHAR(255) NOT NULL,
    color VARCHAR(22),
    displaySize VARCHAR(22),
    ph_length VARCHAR(22),
    width VARCHAR(22),
    camera VARCHAR(22),
    price 	DECIMAL(10,2) NOT NULL,
    PRIMARY KEY(id)
);

CREATE MEMORY TABLE Orders(
	  id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),
    firstName VARCHAR(255) NOT NULL,
    lastName VARCHAR(255) NOT NULL,
    deliveryAddress VARCHAR(255) NOT NULL,
    contactPhoneNo VARCHAR(55),
    description VARCHAR(255),
    totalQuantity BIGINT NOT NULL,
    totalPrice 	DECIMAL(10,2) NOT NULL,
    subTotalPrice 	DECIMAL(10,2) NOT NULL,
    userId BIGINT NOT NULL,
    PRIMARY KEY(id)
);

CREATE MEMORY TABLE OrderItems(
  id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),
	phone_id BIGINT NOT NULL,
	quantity BIGINT NOT NULL,
	order_id BIGINT NOT NULL,
);

CREATE MEMORY TABLE Users(
id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),
firstName VARCHAR(45) NOT NULL,
lastName VARCHAR(45) NOT NULL,
login VARCHAR(45) NOT NULL,
password VARCHAR(45) NOT NULL,
);

-- ALTER TABLE OrderItems
-- ADD CONSTRAINT fk_oi_phone FOREIGN KEY (phone_id) REFERENCES Phones(id) ON DELETE CASCADE;
--
-- ALTER TABLE OrderItems
-- ADD CONSTRAINT fk_oi_order FOREIGN KEY (order_id) REFERENCES Orders(id) ON DELETE CASCADE;

SET DATABASE REFERENTIAL INTEGRITY TRUE;
-- SET REFERENTIAL_INTEGRITY TRUE;
COMMIT;